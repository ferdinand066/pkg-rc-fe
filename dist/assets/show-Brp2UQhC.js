import{B as e,b as s,d as a,f as r,h as i,m as t,r as l,Q as n,i as d,k as o,x as c,j as u}from"./index-DmZMZ_OJ.js";import{I as m}from"./InputSelect-DW4OBw_e.js";import{u as p,I as f}from"./InputText-CWPEA16m.js";import{I as h}from"./InputTextarea-DWcEhy00.js";import{P as x}from"./PageHeader-MC07Bukb.js";import{U as j,a as g}from"./use-user-cVPLzsX5.js";import{A as b,a as y}from"./constants-5vXSpW5c.js";import"./useQuery-15oOikw8.js";class v extends e{static async updateUserProfile(e){try{return await this._post("https://booking-api.parokipik.org/general/user",e)}catch(s){throw new Error(s.message)}}}const N=()=>{const{id:e}=c(),N=t(),{data:U,status:w}=g(e??""),{register:_,setValue:k,errors:q,handleActivateUser:S,handleUpdateRole:I,handleRejectUser:R,handleSubmit:V}=((e=null)=>{const{user:c}=s(),{register:u,setValue:m,formState:{errors:f},handleSubmit:h,reset:x}=p(),[g,y]=a(r),N=i(),U=t();return l.useEffect((()=>{x(),e&&Object.keys(e).forEach((s=>{m(s,e[s])}))}),[e,m]),{register:u,setValue:m,errors:f,handleActivateUser:async function(){if(c&&e&&c.role===b){y(!0);try{await n.promise(j.activateUser(e.id),{pending:"Waiting for activate user!",error:o(),success:d()})}catch(s){}N.invalidateQueries({queryKey:["admin/user",e?.id]}),y(!1)}},handleRejectUser:async function(){if(c&&e&&c.role===b){y(!0);try{await n.promise(j.rejectUser(e.id),{pending:"Waiting for reject user!",error:o(),success:d()})}catch(s){}N.invalidateQueries({queryKey:["admin/user"]}),U("/admin/user"),y(!1)}},handleUpdateProfile:async function(s){if(c&&e&&c.id===e?.id&&!g){y(!0);try{await n.promise(v.updateUserProfile(s),{pending:"Waiting for update profile!",error:o(),success:d()})}catch(a){}N.invalidateQueries({queryKey:["profile"]}),y(!1)}},handleUpdateRole:async function(s){if(c&&e&&c.role===b&&!g){y(!0);try{await n.promise(j.updateUserRole(e.id,s),{pending:"Waiting for update user role!",error:o(),success:d()})}catch(a){}N.invalidateQueries({queryKey:["admin/user",e?.id]}),y(!1)}},handleSubmit:h}})(U),{user:A}=s();l.useEffect((()=>{if(A)return"error"===w?(n.error("Invalid request!"),N("/admin/user")):void 0}),[A,w]);return u.jsx("section",{className:"flex flex-col h-full flex-1 gap-4 mb-8 divide-y",children:"error"!==w&&u.jsxs("div",{className:"flex flex-col",children:["success"===w?u.jsx(x,{pageName:`Data dari ${U.name}`,action:A?A.role!==b?u.jsx(u.Fragment,{}):U?U.account_accepted_at||U.suspended_at?U.account_accepted_at?u.jsx("div",{className:"badge badge-success badge-outline",children:"Active"}):U.suspended_at?u.jsx("div",{className:"badge badge-error badge-outline",children:"Suspended"}):u.jsx(u.Fragment,{}):u.jsxs("div",{className:"flex flex-row gap-4",children:[u.jsx("button",{onClick:()=>R(),className:"btn btn-error",type:"button",children:"Tolak User"}),u.jsx("button",{onClick:()=>S(),className:"btn btn-primary",type:"button",children:"Setujui User"})]}):u.jsx(u.Fragment,{}):u.jsx(u.Fragment,{})}):u.jsx(u.Fragment,{}),u.jsxs("form",{onSubmit:V(I),className:"grid grid-cols-6 gap-4 mx-6",children:[u.jsx("div",{className:"col-span-6 sm:col-span-5",children:u.jsx(f,{label:"Nama",type:"text",name:"name",placeholder:"Contoh: John Doe",disabled:!(A?.role===b),register:_("name",{required:"Nama harus diisi"}),setValue:k,errors:q})}),u.jsx("div",{className:"col-span-6 sm:col-span-4",children:u.jsx(f,{label:"Email",type:"email",name:"email",placeholder:"Contoh: example@gmail.com",disabled:!0,description:U&&!U?.email_verified_at?u.jsx("div",{className:"badge badge-error mt-2",children:"Not verified"}):u.jsx(u.Fragment,{}),register:_("email",{required:"Email harus diisi"}),setValue:k,errors:q})}),u.jsx("div",{className:"col-span-6 sm:col-span-2",children:u.jsx(m,{label:"Role",name:"role",disabled:!(A?.role===b),model:y,register:_("role",{required:"Role harus diisi"}),setValue:k,errors:q})}),u.jsx("div",{className:"col-span-6",children:u.jsx(h,{disabled:!(A?.role===b),label:"Alamat",name:"address",id:"address",register:_("address",{required:"Alamat harus diisi"}),setValue:k,errors:q})}),U?.account_accepted_at&&u.jsx("div",{className:"col-span-6 modal-action flex-row-reverse justify-between",children:u.jsxs("div",{className:"flex flex-row gap-4",children:[u.jsx("button",{onClick:()=>N("/admin/user"),className:"btn btn-neutral",type:"button",children:"Tutup"}),u.jsx("button",{className:"btn btn-primary",type:"submit",children:"Kirim"})]})})]})]})})};export{N as default};
