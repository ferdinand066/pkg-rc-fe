import{B as e,n as s,u as a,f as r,a as i,d as t,r as l,q as n,Q as d,h as o,b as c,w as u,j as m,U as p}from"./index-CFS_nyTF.js";import{I as x}from"./input-select-CbbPI8yP.js";import{u as h,I as f}from"./input-text-B4o_KP5K.js";import{I as j}from"./input-textarea-DdpQpPf1.js";import{P as g}from"./page-header-Btf49FBv.js";import{U as b,a as v}from"./use-user-szvz_9jG.js";import"./useQuery-CRtEa33p.js";class y extends e{static async updateUserProfile(e){try{return await this._post("https://booking-api.parokipik.org/general/user",e)}catch(s){throw new Error(s.message)}}}const N=()=>{const{id:e}=u(),N=t(),{data:U,status:w}=v(e??""),{register:_,setValue:q,errors:k,handleActivateUser:R,handleUpdateRole:S,handleRejectUser:V,handleSubmit:A}=((e=null)=>{const{user:u}=s(),{register:m,setValue:p,formState:{errors:x},handleSubmit:f,reset:j}=h(),[g,v]=a(r),N=i(),U=t();return l.useEffect((()=>{j(),e&&Object.keys(e).forEach((s=>{p(s,e[s])}))}),[e,p,j]),{register:m,setValue:p,errors:x,handleActivateUser:async function(){u&&e&&u.role===n&&(v(!0),await d.promise(b.activateUser(e.id),{pending:"Waiting for activate user!",error:c(),success:o()}),N.invalidateQueries({queryKey:["admin/user",e?.id]}),v(!1))},handleRejectUser:async function(){u&&e&&u.role===n&&(v(!0),await d.promise(b.rejectUser(e.id),{pending:"Waiting for reject user!",error:c(),success:o()}),N.invalidateQueries({queryKey:["admin/user"]}),U("/admin/user"),v(!1))},handleUpdateProfile:async function(s){u&&e&&u.id===e?.id&&(g||(v(!0),await d.promise(y.updateUserProfile(s),{pending:"Waiting for update profile!",error:c(),success:o()}),N.invalidateQueries({queryKey:["profile"]}),v(!1)))},handleUpdateRole:async function(s){u&&e&&u.role===n&&(g||(v(!0),await d.promise(b.updateUserRole(e.id,s),{pending:"Waiting for update user role!",error:c(),success:o()}),N.invalidateQueries({queryKey:["admin/user",e?.id]}),v(!1)))},handleSubmit:f}})(U),{user:E}=s();l.useEffect((()=>{if(E)return"error"===w?(d.error("Invalid request!"),N("/admin/user")):void 0}),[E,w]);return m.jsx("section",{className:"flex flex-col h-full flex-1 gap-4 mb-8 divide-y",children:"error"!==w&&m.jsxs("div",{className:"flex flex-col",children:["success"===w?m.jsx(g,{pageName:`Data dari ${U.name}`,action:E?E.role!==n?m.jsx(m.Fragment,{}):U?U.account_accepted_at||U.suspended_at?U.account_accepted_at?m.jsx("div",{className:"badge badge-success badge-outline",children:"Active"}):U.suspended_at?m.jsx("div",{className:"badge badge-error badge-outline",children:"Suspended"}):m.jsx(m.Fragment,{}):m.jsxs("div",{className:"flex flex-row gap-4",children:[m.jsx("button",{onClick:()=>V(),className:"btn btn-error",type:"button",children:"Tolak User"}),m.jsx("button",{onClick:()=>R(),className:"btn btn-primary",type:"button",children:"Setujui User"})]}):m.jsx(m.Fragment,{}):m.jsx(m.Fragment,{})}):m.jsx(m.Fragment,{}),m.jsxs("form",{onSubmit:A(S),className:"grid grid-cols-6 gap-4 mx-6",children:[m.jsx("div",{className:"col-span-6 sm:col-span-5",children:m.jsx(f,{label:"Nama",type:"text",name:"name",placeholder:"Contoh: John Doe",disabled:!(E?.role===n),register:_("name",{required:"Nama harus diisi"}),setValue:q,errors:k})}),m.jsx("div",{className:"col-span-6 sm:col-span-4",children:m.jsx(f,{label:"Email",type:"email",name:"email",placeholder:"Contoh: example@gmail.com",disabled:!0,description:U&&!U?.email_verified_at?m.jsx("div",{className:"badge badge-error mt-2",children:"Not verified"}):m.jsx(m.Fragment,{}),register:_("email",{required:"Email harus diisi"}),setValue:q,errors:k})}),m.jsx("div",{className:"col-span-6 sm:col-span-2",children:m.jsx(x,{label:"Role",name:"role",disabled:!(E?.role===n),model:p,register:_("role",{required:"Role harus diisi"}),setValue:q,errors:k})}),m.jsx("div",{className:"col-span-6",children:m.jsx(j,{disabled:!(E?.role===n),label:"Alamat",name:"address",id:"address",register:_("address",{required:"Alamat harus diisi"}),setValue:q,errors:k})}),U?.account_accepted_at&&m.jsx("div",{className:"col-span-6 modal-action flex-row-reverse justify-between",children:m.jsxs("div",{className:"flex flex-row gap-4",children:[m.jsx("button",{onClick:()=>N("/admin/user"),className:"btn btn-neutral",type:"button",children:"Tutup"}),m.jsx("button",{className:"btn btn-primary",type:"submit",children:"Kirim"})]})})]})]})})};export{N as default};
