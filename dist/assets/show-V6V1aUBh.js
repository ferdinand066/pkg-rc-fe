import{B as e,b as s,d as a,f as r,h as i,m as t,r as l,Q as n,i as d,k as o,x as c,j as u}from"./index-CCxCR-Er.js";import{U as m,a as p}from"./use-user-ZOjXsmVd.js";import{P as f}from"./PageHeader-D9suwZ9H.js";import{u as h,I as x}from"./InputText-DxAQ4iH9.js";import{I as j}from"./InputSelect-DBKPu1T0.js";import{A as g,a as b}from"./constants-5vXSpW5c.js";import{I as y}from"./InputTextarea-BgtNn0v_.js";import"./useQuery-DjkKE6fm.js";class v extends e{static async updateUserProfile(e){try{return await this._post("https://booking-api.parokipik.org/general/user",e)}catch(s){throw new Error(s.message)}}}const N=()=>{const{id:e}=c(),N=t(),{data:U,status:w}=p(e??""),{register:_,setValue:k,errors:q,handleActivateUser:S,handleUpdateRole:I,handleRejectUser:R,handleSubmit:V}=((e=null)=>{const{user:c}=s(),{register:u,setValue:p,formState:{errors:f},handleSubmit:x,reset:j}=h(),[b,y]=a(r),N=i(),U=t();return l.useEffect((()=>{j(),e&&Object.keys(e).forEach((s=>{p(s,e[s])}))}),[e,p]),{register:u,setValue:p,errors:f,handleActivateUser:async function(){if(c&&e&&c.role===g){y(!0);try{await n.promise(m.activateUser(e.id),{pending:"Waiting for activate user!",error:o(),success:d()})}catch(s){}N.invalidateQueries({queryKey:["admin/user",e?.id]}),y(!1)}},handleRejectUser:async function(){if(c&&e&&c.role===g){y(!0);try{await n.promise(m.rejectUser(e.id),{pending:"Waiting for reject user!",error:o(),success:d()})}catch(s){}N.invalidateQueries({queryKey:["admin/user"]}),U("/admin/user"),y(!1)}},handleUpdateProfile:async function(s){if(c&&e&&c.id===e?.id&&!b){y(!0);try{await n.promise(v.updateUserProfile(s),{pending:"Waiting for update profile!",error:o(),success:d()})}catch(a){}N.invalidateQueries({queryKey:["profile"]}),y(!1)}},handleUpdateRole:async function(s){if(c&&e&&c.role===g&&!b){y(!0);try{await n.promise(m.updateUserRole(e.id,s),{pending:"Waiting for update user role!",error:o(),success:d()})}catch(a){}N.invalidateQueries({queryKey:["admin/user",e?.id]}),y(!1)}},handleSubmit:x}})(U),[A,E]=l.useState(!1),{user:F}=s();l.useEffect((()=>{if(F)return"error"===w?(n.error("Invalid request!"),N("/admin/user")):void(U&&F.id===U.id&&E(!0))}),[F,U,w]);return u.jsx("section",{className:"flex flex-col h-full flex-1 gap-4 mb-8 divide-y",children:"error"!==w&&u.jsxs("div",{className:"flex flex-col",children:["success"===w?u.jsx(f,{pageName:`Data dari ${U.name}`,action:F?F.role!==g?u.jsx(u.Fragment,{}):U?U.account_accepted_at||U.suspended_at?U.account_accepted_at?u.jsx("div",{className:"badge badge-success badge-outline",children:"Active"}):U.suspended_at?u.jsx("div",{className:"badge badge-error badge-outline",children:"Suspended"}):u.jsx(u.Fragment,{}):u.jsxs("div",{className:"flex flex-row gap-4",children:[u.jsx("button",{onClick:()=>R(),className:"btn btn-error",type:"button",children:"Tolak User"}),u.jsx("button",{onClick:()=>S(),className:"btn btn-primary",type:"button",children:"Setujui User"})]}):u.jsx(u.Fragment,{}):u.jsx(u.Fragment,{})}):u.jsx(u.Fragment,{}),u.jsxs("form",{onSubmit:V(I),className:"grid grid-cols-6 gap-4 mx-6",children:[u.jsx("div",{className:"col-span-6 sm:col-span-5",children:u.jsx(x,{label:"Nama",type:"text",name:"name",placeholder:"Contoh: John Doe",disabled:!A,register:_("name",{required:"Nama harus diisi"}),setValue:k,errors:q})}),u.jsx("div",{className:"col-span-6 sm:col-span-4",children:u.jsx(x,{label:"Email",type:"email",name:"email",placeholder:"Contoh: example@gmail.com",disabled:!0,description:U&&!U?.email_verified_at?u.jsx("div",{className:"badge badge-error mt-2",children:"Not verified"}):u.jsx(u.Fragment,{}),register:_("email",{required:"Email harus diisi"}),setValue:k,errors:q})}),u.jsx("div",{className:"col-span-6 sm:col-span-2",children:u.jsx(j,{label:"Role",name:"role",disabled:!(F?.role===g),model:b,register:_("role",{required:"Role harus diisi"}),setValue:k,errors:q})}),u.jsx("div",{className:"col-span-6",children:u.jsx(y,{disabled:!A,label:"Alamat",name:"address",id:"address",register:_("address",{required:"Alamat harus diisi"}),setValue:k,errors:q})}),U?.account_accepted_at&&u.jsx("div",{className:"col-span-6 modal-action flex-row-reverse justify-between",children:u.jsxs("div",{className:"flex flex-row gap-4",children:[u.jsx("button",{onClick:()=>N("/admin/user"),className:"btn btn-neutral",type:"button",children:"Tutup"}),u.jsx("button",{className:"btn btn-primary",type:"submit",children:"Kirim"})]})})]})]})})};export{N as default};
