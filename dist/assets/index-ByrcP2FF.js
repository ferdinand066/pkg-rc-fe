import{r as e,j as a,y as t,R as r,c as n,f as s,h as i,u as o,m as l,b as m}from"./index-CiWvO_dC.js";import{F as u,u as d,I as c}from"./InputText-DGXgaqni.js";import{P as h}from"./PageHeader-HkiibMAb.js";import{T as g,P as b}from"./Table-FM-TymyM.js";import{u as p}from"./use-borrowed-room-Dbj6X_1O.js";import{b as f}from"./constants-5vXSpW5c.js";import{D as v}from"./DialogButton-Cz3Hy9Dy.js";import{I as j}from"./InputSelect-DhIGKHTq.js";import{u as x}from"./use-floor-C_tGvpZK.js";import{u as w}from"./use-room-DTT0JR26.js";import{p as y,i as k,a as S}from"./borrowed-room-service-DTvy3s9D.js";import{b as M,a as N,c as _,d as P,f as W}from"./format-BbihwMOe.js";import"./useQuery-FuiwIscj.js";import"./isValid-5aXsojdQ.js";import"./startOfDay-Cqt31xqJ.js";const C=e.forwardRef((function(a,t){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},a),e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"}))})),F={lessThanXSeconds:{one:"kurang dari 1 detik",other:"kurang dari {{count}} detik"},xSeconds:{one:"1 detik",other:"{{count}} detik"},halfAMinute:"setengah menit",lessThanXMinutes:{one:"kurang dari 1 menit",other:"kurang dari {{count}} menit"},xMinutes:{one:"1 menit",other:"{{count}} menit"},aboutXHours:{one:"sekitar 1 jam",other:"sekitar {{count}} jam"},xHours:{one:"1 jam",other:"{{count}} jam"},xDays:{one:"1 hari",other:"{{count}} hari"},aboutXWeeks:{one:"sekitar 1 minggu",other:"sekitar {{count}} minggu"},xWeeks:{one:"1 minggu",other:"{{count}} minggu"},aboutXMonths:{one:"sekitar 1 bulan",other:"sekitar {{count}} bulan"},xMonths:{one:"1 bulan",other:"{{count}} bulan"},aboutXYears:{one:"sekitar 1 tahun",other:"sekitar {{count}} tahun"},xYears:{one:"1 tahun",other:"{{count}} tahun"},overXYears:{one:"lebih dari 1 tahun",other:"lebih dari {{count}} tahun"},almostXYears:{one:"hampir 1 tahun",other:"hampir {{count}} tahun"}},I={date:M({formats:{full:"EEEE, d MMMM yyyy",long:"d MMMM yyyy",medium:"d MMM yyyy",short:"d/M/yyyy"},defaultWidth:"full"}),time:M({formats:{full:"HH.mm.ss",long:"HH.mm.ss",medium:"HH.mm",short:"HH.mm"},defaultWidth:"full"}),dateTime:M({formats:{full:"{{date}} 'pukul' {{time}}",long:"{{date}} 'pukul' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},O={lastWeek:"eeee 'lalu pukul' p",yesterday:"'Kemarin pukul' p",today:"'Hari ini pukul' p",tomorrow:"'Besok pukul' p",nextWeek:"eeee 'pukul' p",other:"P"},A={code:"id",formatDistance:(e,a,t)=>{let r;const n=F[e];return r="string"==typeof n?n:1===a?n.one:n.other.replace("{{count}}",a.toString()),(null==t?void 0:t.addSuffix)?t.comparison&&t.comparison>0?"dalam waktu "+r:r+" yang lalu":r},formatLong:I,formatRelative:(e,a,t,r)=>O[e],localize:{ordinalNumber:(e,a)=>"ke-"+Number(e),era:N({values:{narrow:["SM","M"],abbreviated:["SM","M"],wide:["Sebelum Masehi","Masehi"]},defaultWidth:"wide"}),quarter:N({values:{narrow:["1","2","3","4"],abbreviated:["K1","K2","K3","K4"],wide:["Kuartal ke-1","Kuartal ke-2","Kuartal ke-3","Kuartal ke-4"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:N({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"],wide:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"]},defaultWidth:"wide"}),day:N({values:{narrow:["M","S","S","R","K","J","S"],short:["Min","Sen","Sel","Rab","Kam","Jum","Sab"],abbreviated:["Min","Sen","Sel","Rab","Kam","Jum","Sab"],wide:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"]},defaultWidth:"wide"}),dayPeriod:N({values:{narrow:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},abbreviated:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},wide:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"}},defaultWidth:"wide",formattingValues:{narrow:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},abbreviated:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},wide:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:_({matchPattern:/^ke-(\d+)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)}),era:P({matchPatterns:{narrow:/^(sm|m)/i,abbreviated:/^(s\.?\s?m\.?|s\.?\s?e\.?\s?u\.?|m\.?|e\.?\s?u\.?)/i,wide:/^(sebelum masehi|sebelum era umum|masehi|era umum)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^s/i,/^(m|e)/i]},defaultParseWidth:"any"}),quarter:P({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^K-?\s[1234]/i,wide:/^Kuartal ke-?\s?[1234]/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:P({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|mei|jun|jul|agt|sep|okt|nov|des)/i,wide:/^(januari|februari|maret|april|mei|juni|juli|agustus|september|oktober|november|desember)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^ma/i,/^ap/i,/^me/i,/^jun/i,/^jul/i,/^ag/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:P({matchPatterns:{narrow:/^[srkjm]/i,short:/^(min|sen|sel|rab|kam|jum|sab)/i,abbreviated:/^(min|sen|sel|rab|kam|jum|sab)/i,wide:/^(minggu|senin|selasa|rabu|kamis|jumat|sabtu)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^m/i,/^s/i,/^s/i,/^r/i,/^k/i,/^j/i,/^s/i],any:[/^m/i,/^sen/i,/^sel/i,/^r/i,/^k/i,/^j/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:P({matchPatterns:{narrow:/^(a|p|tengah m|tengah h|(di(\swaktu)?) (pagi|siang|sore|malam))/i,any:/^([ap]\.?\s?m\.?|tengah malam|tengah hari|(di(\swaktu)?) (pagi|siang|sore|malam))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^pm/i,midnight:/^tengah m/i,noon:/^tengah h/i,morning:/pagi/i,afternoon:/siang/i,evening:/sore/i,night:/malam/i}},defaultParseWidth:"any"})},options:{weekStartsOn:1,firstWeekContainsDate:1}},V=e=>{const{labelClassName:r,inputContainerClassName:n,inputClassName:s,descriptionClassName:i,id:o,name:l,label:m,description:d,setValue:c,errors:h,register:g,onChange:b,component:p,prefix:f,checkboxOptions:v,...j}=e;return v.length>0?a.jsxs("div",{className:"w-full",children:[m&&a.jsx("div",{className:"label",children:a.jsx("span",{className:"label-text",children:m})}),a.jsx("div",{className:"grid grid-cols-2",children:v.map(((e,t)=>a.jsx("div",{className:"form-control",children:a.jsxs("label",{className:"label cursor-pointer justify-start gap-4 items-center",children:[a.jsx("input",{...e.register,id:e.id+"-checkbox",name:e.name,type:"checkbox",value:e.id,className:"checkbox checkbox-primary bg-base-200 shadow",...j}),a.jsx("span",{className:"label-text",children:e.label})]})},t)))}),a.jsxs("div",{className:"label",children:[d&&a.jsx("span",{className:"label-text",children:d}),h&&(t(l??"",h)||h[l??""])&&a.jsx(u,{name:l??"",errors:h})]})]}):a.jsx(a.Fragment,{})},H=e=>{let a;const t=new Set,r=(e,r)=>{const n="function"==typeof e?e(a):e;if(!Object.is(n,a)){const e=a;a=(null!=r?r:"object"!=typeof n||null===n)?n:Object.assign({},a,n),t.forEach((t=>t(a,e)))}},n=()=>a,s={setState:r,getState:n,getInitialState:()=>i,subscribe:e=>(t.add(e),()=>t.delete(e))},i=a=e(r,n,s);return s},K=e=>e;function R(e,a){let t;try{t=e()}catch(r){return}return{getItem:e=>{var a;const r=e=>null===e?null:JSON.parse(e,void 0),n=null!=(a=t.getItem(e))?a:null;return n instanceof Promise?n.then(r):r(n)},setItem:(e,a)=>t.setItem(e,JSON.stringify(a,void 0)),removeItem:e=>t.removeItem(e)}}const E=e=>a=>{try{const t=e(a);return t instanceof Promise?t:{then:e=>E(e)(t),catch(e){return this}}}catch(t){return{then(e){return this},catch:e=>E(e)(t)}}},J={start_date:null,end_date:null,status:null,floor_id:null,room_id:null},B=(e=>{const a=(e=>e?H(e):H)(e),t=e=>function(e,a=K){const t=r.useSyncExternalStore(e.subscribe,(()=>a(e.getState())),(()=>a(e.getInitialState())));return r.useDebugValue(t),t}(a,e);return Object.assign(t,a),t})(((e,a)=>(t,r,n)=>{let s={storage:R((()=>localStorage)),partialize:e=>e,version:0,merge:(e,a)=>({...a,...e}),...a},i=!1;const o=new Set,l=new Set;let m=s.storage;if(!m)return e(((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...e)}),r,n);const u=()=>{const e=s.partialize({...r()});return m.setItem(s.name,{state:e,version:s.version})},d=n.setState;n.setState=(e,a)=>{d(e,a),u()};const c=e(((...e)=>{t(...e),u()}),r,n);let h;n.getInitialState=()=>c;const g=()=>{var e,a;if(!m)return;i=!1,o.forEach((e=>{var a;return e(null!=(a=r())?a:c)}));const n=(null==(a=s.onRehydrateStorage)?void 0:a.call(s,null!=(e=r())?e:c))||void 0;return E(m.getItem.bind(m))(s.name).then((e=>{if(e){if("number"!=typeof e.version||e.version===s.version)return[!1,e.state];if(s.migrate){const a=s.migrate(e.state,e.version);return a instanceof Promise?a.then((e=>[!0,e])):[!0,a]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]})).then((e=>{var a;const[n,i]=e;if(h=s.merge(i,null!=(a=r())?a:c),t(h,!0),n)return u()})).then((()=>{null==n||n(h,void 0),h=r(),i=!0,l.forEach((e=>e(h)))})).catch((e=>{null==n||n(void 0,e)}))};return n.persist={setOptions:e=>{s={...s,...e},e.storage&&(m=e.storage)},clearStorage:()=>{null==m||m.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>g(),hasHydrated:()=>i,onHydrate:e=>(o.add(e),()=>{o.delete(e)}),onFinishHydration:e=>(l.add(e),()=>{l.delete(e)})},s.skipHydration||g(),h||c})(((e,a)=>({...J,getFilter:()=>{const{getFilter:e,setFilter:t,clear:r,status:n,room_id:s,...i}=a();return Object.fromEntries(Object.entries({...i,status:null==n?void 0:n.filter((e=>!!e)),room_id:null==s?void 0:s.filter((e=>!!e))}).filter((([e,a])=>!(!a||Array.isArray(a)&&0===a.length))))},setFilter:a=>e({...a}),clear:()=>e(J)})),{name:"filter-borrowed-room-store"})),D=[{id:1,name:"Pending"},{id:2,name:"Accepted"}],T=e.forwardRef((({},e)=>{const{register:t,setValue:r,errors:o,handleSubmit:l,watch:m,getValues:u,handleFilterBorrowedRoom:h,floors:g,floorStatus:b,rooms:p,roomStatus:f,reset:v,resetFilter:M}=(()=>{const{getFilter:e,setFilter:a}=B(),{register:t,setValue:r,getValues:o,formState:{errors:l},handleSubmit:m,watch:u,reset:c,formState:h}=d({defaultValues:e()}),[g,b]=n(s),p=i(),{data:f,status:v}=x({order_by:"name",data_order:"asc"}),{data:j,status:y}=w({},{order_by:"name",data_order:"asc",floor_id:o("floor_id")},!1,!!o("floor_id"));return{register:t,setValue:r,errors:l,handleSubmit:m,watch:u,getValues:o,formState:h,resetFilter:()=>{c(J),a(J)},reset:c,handleFilterBorrowedRoom:async function(e){g||(b(!0),a(e),p.invalidateQueries({queryKey:["general/borrowed-room"]}),b(!1))},floors:f,floorStatus:v,rooms:j,roomStatus:y}})();return a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"font-bold text-lg",children:"Filter Booking Ruangan"}),a.jsxs("form",{onSubmit:l((async a=>{var t;await h(a),null==(t=e.current)||t.close()})),className:"flex flex-col gap-2",children:[a.jsxs("div",{className:"grid grid-cols-6 gap-4",children:[a.jsx("div",{className:"col-span-6 sm:col-span-3",children:a.jsx(c,{label:"Booking dari",type:"date",name:"start_date",register:t("start_date"),setValue:r,errors:o})}),a.jsx("div",{className:"col-span-6 sm:col-span-3",children:a.jsx(c,{label:"Booking sampai",type:"date",name:"end_date",register:t("end_date",{validate:e=>{if(!e)return!0;const a=y(e),t=u("start_date");if(!t)return!0;const r=y(t);return!(!k(a,r)&&!S(a,r))||"Tanggal harus lebih besar dari tanggal awal"}}),setValue:r,errors:o})})]}),a.jsx(V,{label:"Status",name:"status",id:"status",checkboxOptions:D.map(((e,a)=>({id:""+e.id,label:e.name,name:`status.${a}`,register:t(`status.${a}`)}))),errors:o}),"success"===b&&a.jsx(j,{label:"Lantai",name:"floor_id",value:m("floor_id")??"",register:t("floor_id"),setValue:r,model:g??[]}),"success"===f&&a.jsx(V,{label:"Ruangan",name:"room_id",id:"room_id",checkboxOptions:(p??[]).map(((e,a)=>({id:""+e.id,label:e.name,name:`room_id.${a}`,register:t(`room_id.${a}`)})))}),a.jsx("span",{}),a.jsxs("div",{className:"modal-action flex-row-reverse justify-between",children:[a.jsxs("div",{className:"flex flex-row gap-4",children:[a.jsx("button",{className:"btn bg-base-100 hover:bg-gray-200 border-none",type:"button",onClick:()=>{var a;return v(),null==(a=e.current)?void 0:a.close()},children:"Tutup"}),a.jsx("button",{className:"btn btn-primary",type:"submit",children:"Saring"})]}),a.jsx("button",{className:"btn !ml-0 btn-error",type:"button",onClick:async()=>{var a;return M(),null==(a=e.current)?void 0:a.close()},children:"Reset"})]})]})]})})),X=[{name:"event_name",sortable:!0},{name:"room_name",sortable:!0},{name:"floor",sortable:!0},{name:"borrowed_date",sortable:!0},{name:"start_borrowing_time",sortable:!1},{name:"end_event_time",sortable:!1},{name:"pic_name",sortable:!1},{name:"status",sortable:!1}],q=()=>{const[t,r]=e.useState({page:1}),[n,s]=e.useState({order_by:"borrowed_date",data_order:"asc"}),{getFilter:i}=B(),[u,d]=e.useState(""),j=o(m),{data:x,status:w}=p({...t,...i()},n),y=l(),k=(null==x?void 0:x.data.map((e=>({...{...e,borrowed_date:a.jsx("div",{className:"min-w-56 md:min-w-auto",children:W(e.borrowed_date,"EEEE, d MMMM yyyy",{locale:A})}),event_name:a.jsx("div",{className:"min-w-48 md:min-w-auto",children:e.event_name}),room_name:a.jsx("div",{className:"min-w-36 md:min-w-auto",children:e.room.name}),floor:a.jsx("div",{className:"min-w-20 md:min-w-auto",children:e.room.floor.name}),pic_name:a.jsx("div",{className:"min-w-32 md:min-w-auto",children:e.pic_name}),status:f[e.borrowed_status]},redirect:"/room-request/"+e.id}))))??[],S=e.useRef(null);return a.jsxs("section",{className:"flex flex-col h-full flex-1 gap-4",children:[a.jsx(h,{pageName:"Proposal Pinjam Ruang",action:1===parseInt((null==j?void 0:j.roleId)??"1")?a.jsxs("div",{className:"flex flex-row gap-4",children:[a.jsx("button",{type:"button",onClick:()=>y("/room-request/create"),className:"btn btn-primary h-10 max-h-10 text-sm",children:"Buat Proposal"}),a.jsx("button",{type:"button",onClick:()=>y("/room-request/recurring"),className:"btn btn-primary h-10 max-h-10 text-sm",children:"Buat Proposal Berulang"})]}):a.jsx(a.Fragment,{})}),a.jsxs("div",{className:"mx-6 flex flex-row items-end gap-2 justify-end",children:[a.jsx("div",{className:"w-full lg:max-w-80",children:a.jsx(c,{type:"text",value:u,onChange:e=>d(e.target.value),placeholder:"Cari..."})}),a.jsx(v,{buttonValue:a.jsx(C,{className:"w-5 h-5"}),onClick:()=>{},ref:S,children:a.jsx(T,{ref:S})}),a.jsx("button",{className:"btn w-20 bg-base-100 hover:bg-gray-200 border-none",type:"button",onClick:()=>r((e=>({...e,page:1,search:u}))),children:"Cari"})]}),a.jsx(g,{header:X,data:k??[],status:w,sortData:n,setSortData:s,enableSort:!0}),a.jsx(b,{status:w,data:x,page:t.page,setPage:r})]})};export{q as default};
