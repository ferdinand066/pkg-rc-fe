import{B as e,a,c as s,f as r,h as i,r as t,Q as l,i as d,k as n,x as o,m as c,j as u}from"./index-BOyQT3oY.js";import{U as m,a as p}from"./use-user-dKn67m1P.js";import{P as f}from"./PageHeader-hlWS499s.js";import{u as x,I as h}from"./InputText-CDt11_SU.js";import{I as g}from"./InputSelect-CYVMbrO3.js";import{A as j,a as b}from"./constants-D51TbJpq.js";import{I as v}from"./InputTextarea-By3lboXK.js";import"./useQuery-ickZKot0.js";class y extends e{static async updateUserProfile(e){try{return await this._post("https://booking-api.reginacaeli.id/general/user",e)}catch(a){throw new Error(a.message)}}}const N=()=>{const{id:e}=o(),N=c(),{data:_,status:w}=p(e??""),{register:U,setValue:q,errors:S,handleActivateUser:I,handleUpdateRole:V,handleSubmit:A}=((e=null)=>{const{user:o}=a(),{register:c,setValue:u,formState:{errors:p},handleSubmit:f,reset:h}=x(),[g,b]=s(r),v=i();return t.useEffect((()=>{h(),e&&Object.keys(e).forEach((a=>{u(a,e[a])}))}),[e,u]),{register:c,setValue:u,errors:p,handleActivateUser:async function(){if(o&&e&&o.role===j){b(!0);try{await l.promise(m.activateUser(e.id),{pending:"Waiting for activate user!",error:d(),success:n()})}catch(a){}v.invalidateQueries({queryKey:["admin/user",null==e?void 0:e.id]}),b(!1)}},handleUpdateProfile:async function(a){if(o&&e&&o.id===(null==e?void 0:e.id)&&!g){b(!0);try{await l.promise(y.updateUserProfile(a),{pending:"Waiting for update profile!",error:d(),success:n()})}catch(s){}v.invalidateQueries({queryKey:["profile"]}),b(!1)}},handleUpdateRole:async function(a){if(o&&e&&o.role===j&&!g){b(!0);try{await l.promise(m.updateUserRole(e.id,a),{pending:"Waiting for update user role!",error:d(),success:n()})}catch(s){}v.invalidateQueries({queryKey:["admin/user",null==e?void 0:e.id]}),b(!1)}},handleSubmit:f}})(_),[E,F]=t.useState(!1),{user:P}=a();t.useEffect((()=>{if(P)return"error"===w?(l.error("Invalid request!"),N("/admin/user")):void(_&&P.id===_.id&&F(!0))}),[P,_,w]);return u.jsx("section",{className:"flex flex-col h-full flex-1 gap-4 mb-8 divide-y",children:"error"!==w&&u.jsxs("div",{className:"flex flex-col",children:["success"===w?u.jsx(f,{pageName:`Data dari ${_.name}`,action:P?P.role!==j?u.jsx(u.Fragment,{}):_&&_.email_verified_at?_.account_accepted_at||_.suspended_at?_.account_accepted_at?u.jsx("div",{className:"badge badge-success badge-outline",children:"Active"}):_.suspended_at?u.jsx("div",{className:"badge badge-error badge-outline",children:"Suspended"}):u.jsx(u.Fragment,{}):u.jsx("div",{className:"flex flex-row gap-4",children:u.jsx("button",{onClick:()=>I(),className:"btn btn-primary",type:"button",children:"Setujui User"})}):u.jsx(u.Fragment,{}):u.jsx(u.Fragment,{})}):u.jsx(u.Fragment,{}),u.jsxs("form",{onSubmit:A(V),className:"grid grid-cols-6 gap-4 mx-6",children:[u.jsx("div",{className:"col-span-6 sm:col-span-5",children:u.jsx(h,{label:"Nama",type:"text",name:"name",placeholder:"Contoh: John Doe",disabled:!E,register:U("name",{required:"Nama harus diisi"}),setValue:q,errors:S})}),u.jsx("div",{className:"col-span-6 sm:col-span-4",children:u.jsx(h,{label:"Email",type:"email",name:"email",placeholder:"Contoh: example@gmail.com",disabled:!0,description:_&&!(null==_?void 0:_.email_verified_at)?u.jsx("div",{className:"badge badge-error mt-2",children:"Not verified"}):u.jsx(u.Fragment,{}),register:U("email",{required:"Email harus diisi"}),setValue:q,errors:S})}),u.jsx("div",{className:"col-span-6 sm:col-span-2",children:u.jsx(g,{label:"Role",name:"role",disabled:!((null==P?void 0:P.role)===j),model:b,register:U("role",{required:"Role harus diisi"}),setValue:q,errors:S})}),u.jsx("div",{className:"col-span-6",children:u.jsx(v,{disabled:!E,label:"Alamat",name:"address",id:"address",register:U("address",{required:"Alamat harus diisi"}),setValue:q,errors:S})}),(null==_?void 0:_.account_accepted_at)&&u.jsx("div",{className:"col-span-6 modal-action flex-row-reverse justify-between",children:u.jsxs("div",{className:"flex flex-row gap-4",children:[u.jsx("button",{className:"btn btn-neutral",type:"button",children:"Tutup"}),u.jsx("button",{className:"btn btn-primary",type:"submit",children:"Kirim"})]})})]})]})})};export{N as default};
