import{B as e,a,c as s,f as r,h as i,m as t,r as l,Q as n,i as d,k as o,x as c,j as u}from"./index-BT4yNJiJ.js";import{U as m,a as p}from"./use-user-CG3KaWER.js";import{P as f}from"./PageHeader-Dv_8xu8d.js";import{u as x,I as h}from"./InputText-BdcDWvtD.js";import{I as j}from"./InputSelect-BztCjkQi.js";import{A as g,a as b}from"./constants-5vXSpW5c.js";import{I as v}from"./InputTextarea-DyWML9h_.js";import"./useQuery-G1FIbsiR.js";class y extends e{static async updateUserProfile(e){try{return await this._post("https://booking-api.reginacaeli.id/general/user",e)}catch(a){throw new Error(a.message)}}}const N=()=>{const{id:e}=c(),N=t(),{data:U,status:w}=p(e??""),{register:_,setValue:q,errors:S,handleActivateUser:k,handleUpdateRole:I,handleRejectUser:R,handleSubmit:V}=((e=null)=>{const{user:c}=a(),{register:u,setValue:p,formState:{errors:f},handleSubmit:h,reset:j}=x(),[b,v]=s(r),N=i(),U=t();return l.useEffect((()=>{j(),e&&Object.keys(e).forEach((a=>{p(a,e[a])}))}),[e,p]),{register:u,setValue:p,errors:f,handleActivateUser:async function(){if(c&&e&&c.role===g){v(!0);try{await n.promise(m.activateUser(e.id),{pending:"Waiting for activate user!",error:d(),success:o()})}catch(a){}N.invalidateQueries({queryKey:["admin/user",null==e?void 0:e.id]}),v(!1)}},handleRejectUser:async function(){if(c&&e&&c.role===g){v(!0);try{await n.promise(m.rejectUser(e.id),{pending:"Waiting for reject user!",error:d(),success:o()})}catch(a){}N.invalidateQueries({queryKey:["admin/user"]}),U("/admin/user"),v(!1)}},handleUpdateProfile:async function(a){if(c&&e&&c.id===(null==e?void 0:e.id)&&!b){v(!0);try{await n.promise(y.updateUserProfile(a),{pending:"Waiting for update profile!",error:d(),success:o()})}catch(s){}N.invalidateQueries({queryKey:["profile"]}),v(!1)}},handleUpdateRole:async function(a){if(c&&e&&c.role===g&&!b){v(!0);try{await n.promise(m.updateUserRole(e.id,a),{pending:"Waiting for update user role!",error:d(),success:o()})}catch(s){}N.invalidateQueries({queryKey:["admin/user",null==e?void 0:e.id]}),v(!1)}},handleSubmit:h}})(U),[A,E]=l.useState(!1),{user:F}=a();l.useEffect((()=>{if(F)return"error"===w?(n.error("Invalid request!"),N("/admin/user")):void(U&&F.id===U.id&&E(!0))}),[F,U,w]);return u.jsx("section",{className:"flex flex-col h-full flex-1 gap-4 mb-8 divide-y",children:"error"!==w&&u.jsxs("div",{className:"flex flex-col",children:["success"===w?u.jsx(f,{pageName:`Data dari ${U.name}`,action:F?F.role!==g?u.jsx(u.Fragment,{}):U?U.account_accepted_at||U.suspended_at?U.account_accepted_at?u.jsx("div",{className:"badge badge-success badge-outline",children:"Active"}):U.suspended_at?u.jsx("div",{className:"badge badge-error badge-outline",children:"Suspended"}):u.jsx(u.Fragment,{}):u.jsxs("div",{className:"flex flex-row gap-4",children:[u.jsx("button",{onClick:()=>R(),className:"btn btn-error",type:"button",children:"Tolak User"}),u.jsx("button",{onClick:()=>k(),className:"btn btn-primary",type:"button",children:"Setujui User"})]}):u.jsx(u.Fragment,{}):u.jsx(u.Fragment,{})}):u.jsx(u.Fragment,{}),u.jsxs("form",{onSubmit:V(I),className:"grid grid-cols-6 gap-4 mx-6",children:[u.jsx("div",{className:"col-span-6 sm:col-span-5",children:u.jsx(h,{label:"Nama",type:"text",name:"name",placeholder:"Contoh: John Doe",disabled:!A,register:_("name",{required:"Nama harus diisi"}),setValue:q,errors:S})}),u.jsx("div",{className:"col-span-6 sm:col-span-4",children:u.jsx(h,{label:"Email",type:"email",name:"email",placeholder:"Contoh: example@gmail.com",disabled:!0,description:U&&!(null==U?void 0:U.email_verified_at)?u.jsx("div",{className:"badge badge-error mt-2",children:"Not verified"}):u.jsx(u.Fragment,{}),register:_("email",{required:"Email harus diisi"}),setValue:q,errors:S})}),u.jsx("div",{className:"col-span-6 sm:col-span-2",children:u.jsx(j,{label:"Role",name:"role",disabled:!((null==F?void 0:F.role)===g),model:b,register:_("role",{required:"Role harus diisi"}),setValue:q,errors:S})}),u.jsx("div",{className:"col-span-6",children:u.jsx(v,{disabled:!A,label:"Alamat",name:"address",id:"address",register:_("address",{required:"Alamat harus diisi"}),setValue:q,errors:S})}),(null==U?void 0:U.account_accepted_at)&&u.jsx("div",{className:"col-span-6 modal-action flex-row-reverse justify-between",children:u.jsxs("div",{className:"flex flex-row gap-4",children:[u.jsx("button",{onClick:()=>N("/admin/user"),className:"btn btn-neutral",type:"button",children:"Tutup"}),u.jsx("button",{className:"btn btn-primary",type:"submit",children:"Kirim"})]})})]})]})})};export{N as default};
